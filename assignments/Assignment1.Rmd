---
title: "Assignment1"
author: "cmlostek"
date: "2026-01-22"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
rm(list=ls())
```

# Overview: Consider a “loaded” die that has a 10% chance of getting a 1-5 and a 50% chance of getting a 6.
1 = .1
2 - .1
3 = .1
4 = .1
5 = .1
6 = .5
## Q1 What is the mean of the loaded die?
```{r}
mean = (1 * .1) + (2 * .1) + (3 * .1) + (4 * .1) + (5 * .1) + (6 * .5)
mean
```

## Q2 What is the variance of the loaded die?
``` {r}
var = .1 * (1 - 4.5)^2 + .1 * (2-4.5)^2 + .1 * (3-4.5)^2 + .1 * (4 - 4.5)^2 + .1 * (5 - 4.5)^2 + .5 *(6  - 4.5)^2
var
```

## Q3 Implement a roll function to roll the loaded die.

```{r}
outcomes <- 1:6
weights <- c(.1, .1, .1, .1, .1, .5)
rollDie <- function(n) {
rolls <- sample(outcomes, n, TRUE, weights)
return(rolls)
}

rolls <- rollDie(10000)
```

## Q4 Make a histogram of some large number of rolls.  Do the rolls of the loaded die approximate a uniform distribution?
```{r}
hist(rolls)
```
Since the histogram shows high numbers of 6 (as expected) it is not forming a uniform distribution.

## Q5 Modify the code on Slide #57 of lecture #2 so that the means vs. trial size plots are from the loaded die. Generate these plots a few times.  How many rolls appear to be necessary to get convergence on the expected values for the mean and variance?
```{r}
# 1. Setup
outcomes <- 1:6
weights <- c(.1, .1, .1, .1, .1, .5)
trialSizes <- c(5, 10, 50, 100, 200, 300, 400 , 500, 600, 700, 800, 900, 1000, 2000, 3000, 4000, 5000, 10000, 20000, 30000, 100000)

# Calculate Theoretical Values
theoretical_mean <- sum(outcomes * weights)
theoretical_var <- sum((outcomes - theoretical_mean)^2 * weights)

means <- vector(mode = "double", length = length(trialSizes))
vars <- vector(mode = "double", length = length(trialSizes))

# 2. Simulation (Vectorized)
for (i in 1:length(trialSizes)) {
  rolls <- sample(outcomes, size = trialSizes[i], replace = TRUE, prob = weights)
  means[i] <- mean(rolls)
  vars[i] <- var(rolls)
}

# 3. Plotting
# Set up a side-by-side plot layout
par(mfrow = c(1, 2))

# Left Plot: Means
plot(log10(trialSizes), means, ylim = c(3, 5), xlab = "log10(trialSizes)", ylab = "means")
abline(h = theoretical_mean) # Adds the horizontal reference line
# Right Plot: Variances
plot(log10(trialSizes), vars, ylim = c(3, 5), xlab = "log10(trialSizes)", ylab = "variances")
abline(h = theoretical_var) # Adds the horizontal reference line
```
From this graph the convergence begins to happen in the middle (roughly 1,000 - 10,000 rolls.)